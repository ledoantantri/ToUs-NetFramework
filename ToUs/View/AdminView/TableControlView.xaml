<UserControl x:Class="ToUs.View.AdminView.TableControlView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ToUs.View.AdminView"
             xmlns:viewmodel="clr-namespace:ToUs.ViewModel.AdminViewModel"
             mc:Ignorable="d" 
             Style="{StaticResource Page_Style}"
             xmlns:Icon="http://metro.mahapps.com/winfx/xaml/iconpacks"
             xmlns:customcontrol="clr-namespace:ToUs.Resources.CustomControl"
             d:DesignWidth="2500"
             HorizontalAlignment="Left"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">

    <UserControl.DataContext>
        <viewmodel:TableControlViewModel />
    </UserControl.DataContext>

    <ScrollViewer Width="1740"
          HorizontalAlignment="Right"
          Height="1080"
          Background="Transparent">

        <Grid>

            <Grid.RowDefinitions>

                <RowDefinition Height="auto"/>

                <RowDefinition Height="*"/>

            </Grid.RowDefinitions>

            <Grid Grid.Row="0"
              x:Name="GridHeader"
              Margin="46 95 0 0">

                <TextBlock Style="{StaticResource TextHeader}"
                               Text="BẢNG ĐIỀU KHIỂN"
                               Height="81"
                               VerticalAlignment="Top"
                               HorizontalAlignment="Left"
                               SnapsToDevicePixels="True" />

                <StackPanel  HorizontalAlignment="Right"
                                 Orientation="Horizontal"
                                 FlowDirection="RightToLeft">

                    <!--<Ellipse Height="75"
                             Width="75"
                             VerticalAlignment="Top">

                        <Ellipse.Fill>
                            <ImageBrush ImageSource="/Resources/Images/open-folder.png" />
                        </Ellipse.Fill>
                    </Ellipse>-->

                    <StackPanel>

                        <TextBlock x:Name="TextDateTime"
                                Style="{StaticResource txtPrimary}"
                                Foreground="{StaticResource FifthForegroundColor}"
                                FontSize="18"
                                HorizontalAlignment="Right"
                                MaxWidth="304"
                                Height="24" />

                        <TextBlock TextAlignment="Right"
                                SnapsToDevicePixels="True"><Run Style="{StaticResource txtHeader1}"
                                    Text="Chào mừng " /><Run Text=" " /><Run Style="{StaticResource txtHeader1}"
                                    Foreground="#665D8C"
                                    Text="Trí " /><Run Text=" " /><Run Style="{StaticResource txtHeader1}"
                                    Text="đã đến với " /><Run Text=" " /><Run Style="{StaticResource txtHeader1}"
                                    Foreground="#665D8C"
                                    Text="ToUs!" /></TextBlock>

                    </StackPanel>

                </StackPanel>



            </Grid>

            <Grid x:Name="GridSettings"
                  Grid.Row="1"
              Margin="46 32 43 34">

                <Grid.RowDefinitions>

                    <RowDefinition Height="*"/>

                    <RowDefinition Height="*"/>

                </Grid.RowDefinitions>

                <!--Settings-->
                
                <StackPanel Orientation="Horizontal">

                    <StackPanel>

                        <TextBlock Style="{StaticResource TextHeader}"
                               Text="Thiết Lập"
                               FontSize="45"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Top" />


                        <Border Width="688.11"
                        Height="400"
                        x:Name="BorderInfor"
                        Style="{StaticResource BorderStyle}">

                            <StackPanel HorizontalAlignment="Center"
                                        Margin="33.55 38 34 37">

                                <Button HorizontalAlignment="Center"
                                                Height="75"
                                                Width="285"
                                                Background="{StaticResource PrimaryColor}"
                                                materialDesign:ButtonAssist.CornerRadius="10"
                                                Style="{StaticResource MaterialDesignRaisedButton}"
                                                Command="{Binding LoadExcelCommand}">

                                    <StackPanel Orientation="Horizontal">

                                        <Icon:PackIconMaterial x:Name="IconListBox"
                                                                               Kind="Upload"
                                                                               Foreground="{StaticResource FifthPrimaryColor}"
                                                                               Background="Transparent"
                                                                               Width="36"
                                                                               Height="36"
                                                                               VerticalAlignment="Center" />

                                        <TextBlock x:Name="textBlock"
                                                                   FontSize="30"
                                                                   Margin="37 0 23 0"
                                                                   Foreground="{StaticResource FifthPrimaryColor}"
                                                                   Text="Tải file excel"
                                                                   VerticalAlignment="Center">
                                        </TextBlock>

                                        <ContentPresenter VerticalAlignment="Center" />

                                    </StackPanel>

                                </Button>

                                <TextBlock Style="{StaticResource txtHeader2}"
                                               Margin="5 14 0 0"
                                    Foreground="{StaticResource SixthForegroundColor}"
                                    Text="Đã tải lên file thoikhoabieu.xls thành công!"
                                    FontSize="25" />

                                <TextBlock Style="{StaticResource txtHeader2}"
                                               Margin="5 36 0 0"
                                    Foreground="{StaticResource ThirdForegroundColor}"
                                    Text="Danh sách file Đã tải: "
                                    FontSize="30" />

                                <ScrollViewer>

                                    <ItemsControl x:Name="ListFileExcelName"
                                      SnapsToDevicePixels="True"
                                      ItemsSource="{Binding}"
                                      HorizontalAlignment="Left"
                                      Margin="5 0 0 0">

                                        <ItemsControl.Resources>

                                            <Style TargetType="{x:Type ItemsControl}">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding DataContext.IsScale, RelativeSource={RelativeSource AncestorType={x:Type Window}}, UpdateSourceTrigger=PropertyChanged}" Value="True">

                                                        <DataTrigger.EnterActions>
                                                            <BeginStoryboard>
                                                                <Storyboard>
                                                                    <DoubleAnimation Duration="0:0:0.3"
                                                         Storyboard.TargetProperty="Width"
                                                         From="1515" To="1461" />
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </DataTrigger.EnterActions>

                                                        <DataTrigger.ExitActions>
                                                            <BeginStoryboard>
                                                                <Storyboard>
                                                                    <DoubleAnimation Duration="0:0:0.3"
                                                                         Storyboard.TargetProperty="Width"
                                                                         From="1461" To="1515" />
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </DataTrigger.ExitActions>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ItemsControl.Resources>

                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>

                                                <Grid x:Name="gridItemControl"
                                              Margin="0 4 0 0">

                                                    <Border Width="602.9"
                                                    Height="38" Background="#61A84E">

                                                        <TextBlock Style="{StaticResource txtHeader2}"
                                                                   Margin="13 0 0 0"
                                                       Text="{Binding name}"
                                                                   VerticalAlignment="Center"
                                                       Foreground="{StaticResource FifthPrimaryColor}"
                                                       FontSize="25"
                                                       HorizontalAlignment="Left"/>

                                                    </Border>

                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>

                                        <ItemsControl.ItemsPanel>

                                            <ItemsPanelTemplate>
                                                <WrapPanel />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </ScrollViewer>

                            </StackPanel>

                        </Border>


                    </StackPanel>

                    <StackPanel Margin="74.89 0 0 0">

                        <TextBlock Style="{StaticResource TextHeader}"
                               Text="Thêm thủ công"
                               FontSize="45"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Top" />


                        <Border Width="649.11"
                        Height="400"
                        x:Name="BorderAddSubject"
                        Style="{StaticResource BorderStyle}">

                            <StackPanel HorizontalAlignment="Center"
                                        Margin="33 35 26.4 15">

                                <StackPanel Orientation="Horizontal">

                                    <TextBlock Style="{StaticResource TextHeader}"
                                        Text="Mã lớp"
                                               Margin="0 0 52 0"
                                               FontWeight="Normal"
                                        FontSize="32"
                                        HorizontalAlignment="Left" />

                                    <TextBox Width="401"
                                             HorizontalAlignment="Left"
                                             Style="{StaticResource TextBoxStyle}"/>

                                </StackPanel>

                                <StackPanel Orientation="Horizontal">

                                    <TextBlock Style="{StaticResource TextHeader}"
                                        Text="Giảng viên"
                                               Margin="0 0 1 0"
                                               FontWeight="Normal"
                                        FontSize="32"
                                        HorizontalAlignment="Left" />


                                    <TextBox Width="401"
                                             HorizontalAlignment="Left"
                                             Style="{StaticResource TextBoxStyle}"/>

                                </StackPanel>

                                <StackPanel Orientation="Horizontal">

                                    <TextBlock Style="{StaticResource TextHeader}"
                                        Text="Thứ - Tiết"
                                               Margin="0 0 13 0"
                                               FontWeight="Normal"
                                        FontSize="32"
                                        HorizontalAlignment="Left" />


                                    <TextBox Width="96"
                                             HorizontalAlignment="Left"
                                             Style="{StaticResource TextBoxStyle}"/>

                                    <TextBox Width="96"
                                             HorizontalAlignment="Left"
                                             Style="{StaticResource TextBoxStyle}"/>

                                </StackPanel>

                                <StackPanel Orientation="Horizontal">

                                    <TextBlock Style="{StaticResource TextHeader}"
                                        Text="Hệ"
                                               Margin="0 0 75 0"
                                               FontWeight="Normal"
                                        FontSize="32"
                                        HorizontalAlignment="Left" />

                                    <ComboBox x:Name="ComboBoxSemester"
                                          Width="100"
                                          Margin="43 0 0 0"
                                          Background="Transparent"
                                          FontSize="20"
                                          Foreground="{StaticResource FifthForegroundColor}"
                                          ItemsSource="{Binding ShortStringList}"
                                          Style="{StaticResource MaterialDesignOutlinedComboBox}" />




                                </StackPanel>


                                <Grid>

                                    <Button HorizontalAlignment="Left"
                                                Height="50"
                                                Width="50"
                                                Background="{StaticResource PrimaryColor}"
                                                materialDesign:ButtonAssist.CornerRadius="25"
                                                Style="{StaticResource MaterialDesignRaisedButton}"
                                                Command="{Binding LoadExcelCommand}">


                                        <Icon:PackIconMaterial Kind="Plus"
                                                                               Foreground="{StaticResource FifthPrimaryColor}"
                                                                               Background="Transparent"
                                                                               Width="18"
                                                                               Height="25"
                                                                               />


                                    </Button>

                                    <Button HorizontalAlignment="Right"
                                        Margin="5 0 0 0"
                                        Height="50"
                                        Width="140"
                                        Command="{Binding CreateTableCommand}"
                                        Background="{StaticResource PrimaryColor}"
                                        materialDesign:ButtonAssist.CornerRadius="10"
                                        Style="{StaticResource MaterialDesignRaisedButton}">

                                        <StackPanel Orientation="Horizontal">

                                            <Icon:PackIconMaterial Panel.ZIndex="100"
                                                               Margin="0 0 10 0"
                                                                   Kind="ContentSave"
                                                                   Foreground="{StaticResource FifthPrimaryColor}"
                                                                   Background="Transparent"
                                                                   Width="36"
                                                                   Height="36"
                                                                   VerticalAlignment="Center" />

                                            <TextBlock FontSize="30"
                                                   Margin="5 0 23 0"
                                                   Foreground="{StaticResource FifthPrimaryColor}"
                                                   Text="Lưu"
                                                   VerticalAlignment="Center">
                                            </TextBlock>

                                            <ContentPresenter VerticalAlignment="Center" />

                                        </StackPanel>

                                    </Button>


                                </Grid>

                            </StackPanel>

                        </Border>


                    </StackPanel>

                </StackPanel>
                
                <!--List Of Subjects-->
                
                <StackPanel Grid.Row="1"
                            Margin="0 32 0 0">

                    <TextBlock Style="{StaticResource TextHeader}"
                               Text="DANH SÁCH CÁC LỚP ĐÃ THÊM THỦ CÔNG"
                               FontSize="45"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Top" />

                    <Border
            Grid.Row="1"
            Height="766"
            MaxWidth="1673"
            Background="{StaticResource FifthPrimaryColor}"
            CornerRadius="45">

                        <DataGrid
                x:Name="ExcelTimetableDataGrid"
                Margin="45,26,20,0"
                CellStyle="{DynamicResource DataGridCellStyle}"
                ColumnHeaderStyle="{DynamicResource DataGridColumnHeaderStyle}"
                ItemsSource="{Binding DataRowsView, UpdateSourceTrigger=PropertyChanged}"
                RowStyle="{DynamicResource DataGridRowStyle}"
                Style="{DynamicResource DataGridStyle}">

                            <DataGrid.Columns>

                                <!--  Môn  -->

                                <DataGridTemplateColumn
                        Width="260"
                        Header="Môn"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>
                                            <TextBlock
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Subject.Name}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  Mã lớp  -->

                                <DataGridTemplateColumn
                        Width="250"
                        Header="Mã lớp"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>

                                            <StackPanel Orientation="Horizontal">

                                                <!--Click="CkbClassIdClick_HandleEvent"-->
                                                <CheckBox
                                        x:Name="ckbClassId"
                                        materialDesign:CheckBoxAssist.CheckBoxSize="45"
                                       
                                        IsChecked="{Binding IsChecked, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                                                <!--<CheckBox.Triggers />-->

                                                <TextBlock
                                        Margin="10,0,0,0"
                                        Style="{StaticResource TextDataGrid}"
                                        Text="{Binding Class.Id}"
                                        TextTrimming="CharacterEllipsis" />

                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  Giảng viên  -->

                                <DataGridTemplateColumn
                        Width="220"
                        Header="Giảng viên"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>

                                            <TextBlock
                                    HorizontalAlignment="Center"
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Teacher.Name}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  Số TC  -->

                                <DataGridTemplateColumn
                        Width="98"
                        Header="Số TC"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock
                                    HorizontalAlignment="Center"
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Subject.NumberOfDigits}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  Thứ  -->

                                <DataGridTemplateColumn
                        Width="73"
                        Header="Thứ"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>

                                            <TextBlock
                                    HorizontalAlignment="Center"
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Class.DayInWeek}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  Tiết  -->

                                <DataGridTemplateColumn
                        Width="71"
                        Header="Tiết"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>

                                            <TextBlock
                                    HorizontalAlignment="Center"
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Class.Lession}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  Hệ ĐT  -->

                                <DataGridTemplateColumn
                        Width="106"
                        Header="Hệ ĐT"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>

                                            <TextBlock
                                    HorizontalAlignment="Center"
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Class.System}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  Khoa QL  -->

                                <DataGridTemplateColumn
                        Width="139"
                        Header="Khoa QL"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>

                                            <TextBlock
                                    HorizontalAlignment="Center"
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Subject.Faculity}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  HTDG  -->

                                <DataGridTemplateColumn
                        Width="108"
                        Header="HTDG"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>

                                            <TextBlock
                                    HorizontalAlignment="Center"
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Subject.HTGD}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--  Cách tuần  -->

                                <DataGridTemplateColumn
                        Width="196"
                        Header="Cách tuần"
                        IsReadOnly="True">

                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>

                                            <TextBlock
                                    HorizontalAlignment="Center"
                                    Style="{StaticResource TextDataGrid}"
                                    Text="{Binding Class.Frequency}"
                                    TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>


                </StackPanel>

            </Grid>


        </Grid>

    </ScrollViewer>
    
</UserControl>
